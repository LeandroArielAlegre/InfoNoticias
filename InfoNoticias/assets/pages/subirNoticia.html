<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
<<<<<<< Updated upstream
    <title>Subir noticia</title>
</head>

<body>
    <h1>Subir nueva noticia:</h1>
    <form id="userForm">
        <label>
            Título: <input type="text" name="titulo" required>
        </label><br><br>
        <label>
            Descripción: <input type="text" name="descripcion" required>
        </label><br><br>
        <label>
            Cuerpo: <input type="text" name="cuerpo" min="0">
        </label><br><br>
        <label>
            Dirección: <input type="text" name="direccion" min="0">
        </label><br><br>
        <button type="submit">Submit</button>
    </form>

    <script>
        document.getElementById('userForm').addEventListener('submit', async function (e) {
            e.preventDefault();
            const formData = new FormData(e.target);
=======
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="../..//assets/css/noticia.css">
    <link rel="stylesheet" href="../..//assets/css/nav.css">
    <link rel="stylesheet" href="../../assets/css/formulario.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>
    <script src="../../assets/scripts/data.js"></script>
    <script src="../../assets/scripts/subirNoticia.js"></script>

    <title>Formulario de noticia</title>
</head>

<body>
    <nav>
        <ul>
            <li><a href="../../index.html">Inicio</a></li>
            <li><a href="../../assets/pages/subirNoticia.html">Subir noticia</a></li>
        </ul>

    </nav>
    <div class="contendedor">

        <div class="registrarNoticia">
            <form id="registrarNoticia">
                <h1>Formulario de noticia</h1>
                <input type="text" id="tituloNoticia" required name="tituloNoticia" placeholder="Titulo de la noticia">
                <input type="text" id="temaNoticia" required name="temaNoticia" placeholder="Tema de la noticia">
                <input type="text" id="autorNoticia" required name="autorNoticia" placeholder="Autor de la noticia">
                <input type="text" id="fechaNoticia" required name="fechaNoticia" placeholder="Fecha de la noticia">
                <textarea class="textareaDescripcion" id="descripcionNoticia" required name="descripcionNoticia"
                    placeholder="Descripcion de la noticia"></textarea>
                <textarea class="textareaCuerpo" id="cuerpoNoticia" required name="cuerpoNoticia"
                    placeholder="Informacion de la noticia"></textarea>
                <input type="text" id="imagenNoticia" placeholder="Imagenes de la noticia">
                <label><input type="checkbox" name="existeDireccion" value="1"> ¿Tienes una direccion?</label>
                <br>
                <input type="text" id="direccionNormalizadaNoticia" name="direccionNormalizadaNoticia" placeholder="Direccion normalizada de la noticia" style="display:none;">
                <input type="submit" value="Registrar">
            </form>

              <form id="buscarDireccion">
                    <div class="direccionNoticia" style="display: none;">
                        <input type="text" id="calleNoticia" required name="calleNoticia" placeholder="Calle">
                        <input type="text" id="alturaNoticia" required name="alturaNoticia" placeholder="Altura">
                        <input type="submit" value="Buscar">
                    </div>
                </form>

                <div class="direcciones">
                  <!-- <li><button type="button" class="boton-opcion">Cras justo odio</button></li>-->
                    
                </div>



        </div>

>>>>>>> Stashed changes

            sessionStorage.setItem('titulo', formData.get('titulo'));
            sessionStorage.setItem('descripcion', formData.get('descripcion'));
            sessionStorage.setItem('cuerpo', formData.get('cuerpo'));

            const direccionSolicitada = formData.get('direccion');

            // queremos agregar una direccion?
            if (direccionSolicitada.trim != "") {
                const requestURL = 'https://servicios.usig.buenosaires.gob.ar/normalizar/?direccion=' + direccionSolicitada;

                try {
                    const response = await fetch(requestURL);
                    if (!response.ok) throw new Error('Network response was not ok');

                    const data = await response.json();
                    const resultados = data.direccionesNormalizadas;

                    if (resultados.length == 0) {
                        alert('No se encontraron resultados. Revise la dirección e intente nuevamente');
                    }

                    if (resultados.length === 1) {
                        // Se encontro una sola. Genial
                        sessionStorage.setItem('hayDireccion', true);
                        sessionStorage.setItem('direccionNorm', resultados[0].direccion);
                        sessionStorage.setItem('coordX', resultados[0].coordenadas.x);
                        sessionStorage.setItem('coordY', resultados[0].coordenadas.y);
                        const direccionNorm = resultados[0].direccion;
                        const coordX = resultados[0].coordenadas.x;
                        const coordY = resultados[0].coordenadas.y;
                    } else {
                        // Zero or more than one result → show error message
                        alert('Se encontraron ' + resultados.length + ' direcciones. Por favor, intente ser más específico.');
                    }
                } catch (error) {
                    console.error('Fetch error:', error);
                    alert('Error al obtener la dirección. Por favor, intente más tarde.');
                }
            }
            else{
                sessionStorage.setItem(hayDireccion, false);
            }
            window.location.href = 'report.html'
        });
    </script>
</body>

</html>